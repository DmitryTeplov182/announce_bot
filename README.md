# üö¥‚Äç‚ôÇÔ∏è Announce Bot

Telegram –±–æ—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∞–Ω–æ–Ω—Å–æ–≤ –≤–µ–ª–æ–ø–æ–µ–∑–¥–æ–∫ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ–º GPX –º–∞—Ä—à—Ä—É—Ç–æ–≤ –∏–∑ Komoot. –ë–æ–ª—å—à–æ–µ —Å–ø–∞—Å–∏–±–æ –ø—Ä–æ–µ–∫—Ç—É [komootgpx](https://github.com/timschneeb/KomootGPX) –∑–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–∫–∞—á–∏–≤–∞—Ç—å GPX —Ñ–∞–π–ª—ã.

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üìÖ –°–æ–∑–¥–∞–Ω–∏–µ –∞–Ω–æ–Ω—Å–æ–≤ —Å –¥–∞—Ç–æ–π –∏ –≤—Ä–µ–º–µ–Ω–µ–º
- üó∫Ô∏è –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ GPX –º–∞—Ä—à—Ä—É—Ç–æ–≤ –∏–∑ Komoot
- üìç –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ —Ç–æ—á–∫–∏ —Å—Ç–∞—Ä—Ç–∞
- üåùüåö –í—ã–±–æ—Ä —Ç–µ–º–ø–∞ –ø–æ–µ–∑–¥–∫–∏
- üí¨ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
- üîÑ –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –ª—é–±–æ–º —ç—Ç–∞–ø–µ
- üì± –£–¥–æ–±–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –∫–Ω–æ–ø–∫–∞–º–∏


## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –õ–æ–∫–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
```bash
git clone <repository-url>
cd announce_bot
```

2. –°–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:
```bash
python -m venv venv
source venv/bin/activate  # Linux/Mac
```

3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
pip install -r requirements.txt
```

4. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```bash
# –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ: —Ç–æ–∫–µ–Ω Telegram –±–æ—Ç–∞ (–ø–æ–ª—É—á–∏—Ç—å —É @BotFather)
TELEGRAM_TOKEN=your_bot_token_here

# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –≤—Ä–µ–º–µ–Ω–Ω–∞—è –∑–æ–Ω–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é Europe/Belgrade)
# –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –≤—Å–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ timezone –∏–∑ IANA database
# –ü—Ä–∏–º–µ—Ä—ã: Europe/Belgrade, Europe/Moscow, America/New_York, Asia/Tokyo, UTC
TIMEZONE=Europe/Belgrade
```

5. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞:
```bash
python bot.py
```

**–ì–æ—Ç–æ–≤–æ!** –ë–æ—Ç —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å —Ç–æ—á–∫–∞–º–∏ —Å—Ç–∞—Ä—Ç–∞ –¥–ª—è –ù–æ–≤–∏ –°–∞–¥–∞ –∏ –≥–æ—Ç–æ–≤—ã–º–∏ –º–∞—Ä—à—Ä—É—Ç–∞–º–∏. –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤—Å–µ –≥–æ—Ç–æ–≤—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã –≤ –∫–µ—à –¥–ª—è –±—ã—Å—Ç—Ä–æ–π —Ä–∞–±–æ—Ç—ã.

### Docker —É—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
```bash
git clone git@github.com:DmitryTeplov182/announce_bot.git
cd announce_bot
```

2. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` —Å —Ç–æ–∫–µ–Ω–æ–º –±–æ—Ç–∞:
```bash
TELEGRAM_TOKEN=your_bot_token_here
```

3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —á–µ—Ä–µ–∑ Docker Compose:
```bash
# –ü–µ—Ä–µ–∏–º–µ–Ω—É–π—Ç–µ compose.yml.demo –≤ docker-compose.yml
cp compose.yml.demo docker-compose.yml

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker-compose up --build -d
```

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –¢–æ—á–∫–∏ —Å—Ç–∞—Ä—Ç–∞

–¢–æ—á–∫–∏ —Å—Ç–∞—Ä—Ç–∞ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –≤ —Ñ–∞–π–ª–µ `start_points.json`:

```json
{
  "start_points": [
    {
      "name": "koferajd",
      "link": "https://maps.app.goo.gl/iTBcRqjvhJ9DYvRK7"
    },
    {
      "name": "–§–ª–∞–≥–∏", 
      "link": "https://maps.app.goo.gl/j95ME2cuzX8k9hnj7"
    }
  ]
}
```

### –ì–æ—Ç–æ–≤—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã

–ì–æ—Ç–æ–≤—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –≤ —Ñ–∞–π–ª–µ `routes.json`:

```json
{
  "routes": [
    {
      "name": "–†—É–º–µ–Ω–∫–∞ - –§—É—Ç–æ–≥ - –Ø–º–∞(–û—Ç –ë—É–ª—å–≤–∞—Ä–∞ –ï–≤—Ä–æ–ø—ã)",
      "link": "https://www.komoot.com/tour/2526993761"
    },
    {
      "name": "Frushka Lite CCW(–æ—Ç –§–ª–∞–≥–æ–≤)",
      "link": "https://www.komoot.com/tour/2396106518"
    }
  ]
}
```

### –§–æ—Ä–º–∞—Ç –ø–æ–ª–µ–π:
- `name` - –Ω–∞–∑–≤–∞–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–∞ (–æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –Ω–∞ –∫–Ω–æ–ø–∫–µ)
- `link` - —Å—Å—ã–ª–∫–∞ –Ω–∞ –º–∞—Ä—à—Ä—É—Ç Komoot

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- `/status` - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –±–æ—Ç–∞ –∏ –∫–µ—à–∞
- `/clear_cache` - –æ—á–∏—Å—Ç–∏—Ç—å –∫–µ—à GPX —Ñ–∞–π–ª–æ–≤

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤ –∏ —Ç–æ—á–µ–∫ —Å—Ç–∞—Ä—Ç–∞:
–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª—ã `routes.json` –∏ `routes.json` - –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—Ç—Å—è –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞.

## üì± –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

- `/start` - —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∞–Ω–æ–Ω—Å
- `/help` - –ø–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É
- `/status` - —Å—Ç–∞—Ç—É—Å –±–æ—Ç–∞ –∏ –∫–µ—à–∞
- `/clear_cache` - –æ—á–∏—Å—Ç–∏—Ç—å –∫–µ—à GPX —Ñ–∞–π–ª–æ–≤ (–Ω–µ –≤–∏–¥–Ω–∞ –ø—Ä–æ—Å—Ç–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é, –Ω–æ –¥–æ—Å—Ç—É–ø–Ω–∞)
- `/restart` - —Å–±—Ä–æ—Å–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ

## üîß –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.8+
- [komootgpx](https://github.com/timschneeb/KomootGPX)
- Telegram Bot Token

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
announce_bot/
‚îú‚îÄ‚îÄ bot.py                 # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥ –±–æ—Ç–∞
‚îú‚îÄ‚îÄ start_points.json      # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–æ—á–µ–∫ —Å—Ç–∞—Ä—Ç–∞
‚îú‚îÄ‚îÄ routes.json            # –ì–æ—Ç–æ–≤—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã
‚îú‚îÄ‚îÄ requirements.txt       # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
‚îú‚îÄ‚îÄ .env                  # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ .dockerignore         # –ò—Å–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è Docker
‚îú‚îÄ‚îÄ Dockerfile            # –û–±—Ä–∞–∑ Docker
‚îú‚îÄ‚îÄ compose.yml.demo      # –ü—Ä–∏–º–µ—Ä Docker Compose
‚îú‚îÄ‚îÄ Makefile              # –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
‚îú‚îÄ‚îÄ cache/                # –ö—ç—à GPX —Ñ–∞–π–ª–æ–≤
‚îú‚îÄ‚îÄ logs/                 # –õ–æ–≥–∏ (–ø—Ä–∏ Docker)
‚îî‚îÄ‚îÄ README.md            # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞.

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
```bash
# –ê–∫—Ç–∏–≤–∞—Ü–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
source venv/bin/activate

# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
pytest tests/

# –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º –∫–æ–¥–∞
pytest tests/ --cov=bot --cov-report=term-missing

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Makefile
make test
```

### –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞
- ‚úÖ **–í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤**: 41
- ‚úÖ **–ü—Ä–æ—Ö–æ–¥—è—Ç**: 41
- üìä **–ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞**: 37%
- ‚ö° **–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**: ~2 —Å–µ–∫—É–Ω–¥—ã

–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ—Å—Ç–∞—Ö: [README_TESTS.md](README_TESTS.md)

## üö® –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –º–∞—Ä—à—Ä—É—Ç—ã Komoot –ø—É–±–ª–∏—á–Ω—ã–µ
- `komootgpx` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω –≤ PATH
- **–ö—ç—à –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞–µ—Ç—Å—è –æ—Ç —Ñ–∞–π–ª–æ–≤ —Å—Ç–∞—Ä—à–µ 180 –¥–Ω–µ–π**
- **–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤—Å–µ –≥–æ—Ç–æ–≤—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã –≤ –∫–µ—à**

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

THE BEER-WARE LICENSE